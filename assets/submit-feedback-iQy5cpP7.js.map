{"version":3,"file":"submit-feedback-iQy5cpP7.js","sources":["../../src/js/other-section/submit-feedback.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst refs = {\n  closeModalBtn: document.querySelector('.feedbacks-modal-btn'),\n  modal: document.querySelector('.feedbacks-modal'),\n  form: document.querySelector('.feedbacks-modal-form'),\n  submitBtn: document.querySelector('.feedback-modal-submit'),\n  body: document.body,\n};\n\nconst setSubmitState = isValid => {\n  refs.submitBtn.disabled = !isValid;\n\n  refs.submitBtn.style.opacity = isValid ? '1' : '0.5';\n  refs.submitBtn.style.cursor = isValid ? 'pointer' : 'not-allowed';\n};\n\nconst validateForm = () => {\n  if (!refs.form && !refs.submitBtn) return;\n\n  const name = refs.form.querySelector('input[name=\"name\"]');\n  const message = refs.form.querySelector('textarea[name=\"message\"]');\n  const rating = refs.form.querySelector('input[name=\"rating\"]:checked');\n\n  const isNameValid = name && name.value.trim() !== '';\n  const isMessageValid = message && message.value.trim() !== '';\n  const isRatingSelected = rating !== null;\n\n  const isValid = isNameValid && isMessageValid && isRatingSelected;\n\n  setSubmitState(isValid);\n};\n\nconst onEscKeyPress = e => {\n  if (e.key === 'Escape') closeModal();\n};\n\nexport const openModal = () => {\n  refs.modal.classList.remove('is-hidden');\n  refs.body.style.overflow = 'hidden';\n\n  document.addEventListener('keydown', onEscKeyPress);\n  validateForm();\n};\n\nconst closeModal = () => {\n  refs.modal.classList.add('is-hidden');\n  refs.body.style.overflow = '';\n  document.removeEventListener('keydown', onEscKeyPress);\n  refs.form.reset();\n  validateForm();\n};\n\nrefs.form.addEventListener('input', validateForm);\nrefs.form.addEventListener('change', validateForm);\n\nrefs.closeModalBtn.addEventListener('click', closeModal);\n\nrefs.modal.addEventListener('click', e => {\n  if (e.target === refs.modal) closeModal();\n});\n\nvalidateForm();\n\nrefs.form.addEventListener('submit', async e => {\n  e.preventDefault();\n\n  const formData = new FormData(e.currentTarget);\n\n  const data = {\n    name: formData.get('name').trim(),\n    rating: Number(formData.get('rating')),\n    descr: formData.get('message').trim(),\n  };\n\n  try {\n    const response = await fetch(\n      'https://sound-wave.b.goit.study/api/feedbacks',\n      {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data),\n      }\n    );\n\n    if (!response.ok) {\n      const errorResult = await response.json();\n      throw new Error(errorResult.message || 'Something went wrong.');\n    }\n\n    iziToast.success({\n      title: 'Success',\n      message: 'Thank you for your feedback!',\n      position: 'topRight',\n    });\n\n    closeModal();\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: error.message,\n      position: 'topRight',\n    });\n  }\n});\n"],"names":["refs","setSubmitState","isValid","validateForm","name","message","rating","isNameValid","isMessageValid","onEscKeyPress","e","closeModal","openModal","formData","data","response","errorResult","iziToast","error"],"mappings":"yCAGA,MAAMA,EAAO,CACX,cAAe,SAAS,cAAc,sBAAsB,EAC5D,MAAO,SAAS,cAAc,kBAAkB,EAChD,KAAM,SAAS,cAAc,uBAAuB,EACpD,UAAW,SAAS,cAAc,wBAAwB,EAC1D,KAAM,SAAS,IACjB,EAEMC,EAAiBC,GAAW,CAChCF,EAAK,UAAU,SAAW,CAACE,EAE3BF,EAAK,UAAU,MAAM,QAAUE,EAAU,IAAM,MAC/CF,EAAK,UAAU,MAAM,OAASE,EAAU,UAAY,aACtD,EAEMC,EAAe,IAAM,CACzB,GAAI,CAACH,EAAK,MAAQ,CAACA,EAAK,UAAW,OAEnC,MAAMI,EAAOJ,EAAK,KAAK,cAAc,oBAAoB,EACnDK,EAAUL,EAAK,KAAK,cAAc,0BAA0B,EAC5DM,EAASN,EAAK,KAAK,cAAc,8BAA8B,EAE/DO,EAAcH,GAAQA,EAAK,MAAM,KAAM,IAAK,GAC5CI,EAAiBH,GAAWA,EAAQ,MAAM,KAAM,IAAK,GAK3DJ,EAFgBM,GAAeC,GAFNF,IAAW,IAId,CACxB,EAEMG,EAAgBC,GAAK,CACrBA,EAAE,MAAQ,UAAUC,EAAU,CACpC,EAEaC,EAAY,IAAM,CAC7BZ,EAAK,MAAM,UAAU,OAAO,WAAW,EACvCA,EAAK,KAAK,MAAM,SAAW,SAE3B,SAAS,iBAAiB,UAAWS,CAAa,EAClDN,GACF,EAEMQ,EAAa,IAAM,CACvBX,EAAK,MAAM,UAAU,IAAI,WAAW,EACpCA,EAAK,KAAK,MAAM,SAAW,GAC3B,SAAS,oBAAoB,UAAWS,CAAa,EACrDT,EAAK,KAAK,QACVG,GACF,EAEAH,EAAK,KAAK,iBAAiB,QAASG,CAAY,EAChDH,EAAK,KAAK,iBAAiB,SAAUG,CAAY,EAEjDH,EAAK,cAAc,iBAAiB,QAASW,CAAU,EAEvDX,EAAK,MAAM,iBAAiB,QAASU,GAAK,CACpCA,EAAE,SAAWV,EAAK,OAAOW,EAAU,CACzC,CAAC,EAEDR,IAEAH,EAAK,KAAK,iBAAiB,SAAU,MAAMU,GAAK,CAC9CA,EAAE,eAAc,EAEhB,MAAMG,EAAW,IAAI,SAASH,EAAE,aAAa,EAEvCI,EAAO,CACX,KAAMD,EAAS,IAAI,MAAM,EAAE,KAAM,EACjC,OAAQ,OAAOA,EAAS,IAAI,QAAQ,CAAC,EACrC,MAAOA,EAAS,IAAI,SAAS,EAAE,KAAM,CACzC,EAEE,GAAI,CACF,MAAME,EAAW,MAAM,MACrB,gDACA,CACE,OAAQ,OACR,QAAS,CAAE,eAAgB,kBAAoB,EAC/C,KAAM,KAAK,UAAUD,CAAI,CAC1B,CACP,EAEI,GAAI,CAACC,EAAS,GAAI,CAChB,MAAMC,EAAc,MAAMD,EAAS,OACnC,MAAM,IAAI,MAAMC,EAAY,SAAW,uBAAuB,CAC/D,CAEDC,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,+BACT,SAAU,UAChB,CAAK,EAEDN,GACD,OAAQO,EAAO,CACdD,EAAS,MAAM,CACb,MAAO,QACP,QAASC,EAAM,QACf,SAAU,UAChB,CAAK,CACF,CACH,CAAC"}